<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
    <title>real_data</title>
</head>
<body>
    <canvas id="canvas" width="960" height="640"></canvas>

    <script src="../deps/three/build/three.min.js"></script>
    <script src="../deps/three/examples/js/controls/OrbitControls.js"></script>
    <script src="../deps/three/examples/js/libs/stats.min.js"></script>

    <script type="module">
    (async () => {
       // Scene, Camera, Renderer를 생성합니다.
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // 태양, 지구, 화성의 정보를 정의합니다.
        const sunGeometry = new THREE.SphereGeometry(5, 32, 32);
        const sunMaterial = new THREE.MeshBasicMaterial({ color: 0xffff00 });
        const sun = new THREE.Mesh(sunGeometry, sunMaterial);

        const earthGeometry = new THREE.SphereGeometry(1, 32, 32);
        const earthMaterial = new THREE.MeshBasicMaterial({ color: 0x0000ff });
        const earth = new THREE.Mesh(earthGeometry, earthMaterial);
        earth.position.x = 15; // 지구의 초기 위치를 설정합니다.

        const marsGeometry = new THREE.SphereGeometry(0.8, 32, 32);
        const marsMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });
        const mars = new THREE.Mesh(marsGeometry, marsMaterial);
        mars.position.x = 20; // 화성의 초기 위치를 설정합니다.

        // 각 행성의 초기 속도를 설정합니다.
        const earthVelocity = new THREE.Vector3(0, 0, -0.1);
        const marsVelocity = new THREE.Vector3(0, 0, -0.08);

        // Scene에 행성들을 추가합니다.
        scene.add(sun);
        scene.add(earth);
        scene.add(mars);

        // 카메라를 설정합니다.
        camera.position.z = 30;
        
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        const render = () => {
            renderer.render(scene, camera);
        };

        controls.addEventListener('change', render);

        // 애니메이션 루프를 정의합니다.
        function animate() {
            requestAnimationFrame(animate);

            // 각 행성의 운동을 시뮬레이션합니다.
            earth.position.add(earthVelocity);
            mars.position.add(marsVelocity);

            // 중력 법칙을 적용합니다.
            applyGravity(earth, sun);
            applyGravity(mars, sun);
            applyGravity(earth, mars);

            renderer.render(scene, camera);
        }

        // 중력 법칙을 적용하는 함수를 정의합니다.
        function applyGravity(object1, object2) {
            const distanceVector = new THREE.Vector3();
            distanceVector.subVectors(object2.position, object1.position);
            const distanceSquare = distanceVector.lengthSq();
            const gravityForce = 0.1 / distanceSquare; // 중력 상수를 조절하여 시뮬레이션을 조정할 수 있습니다.
            distanceVector.normalize().multiplyScalar(gravityForce);
            object1.position.add(distanceVector);
        }

        // 애니메이션을 시작합니다.
        animate();


    })();
    </script>
</body>
</html>
